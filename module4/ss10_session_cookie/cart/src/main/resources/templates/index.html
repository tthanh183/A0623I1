<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body>
<a th:href="@{/books}">Book shop</a>
<div class="container row">
    <div class="card col-2" style="width: 20rem;" th:each="book : ${books}">
        <img th:src="@{${book.img}}" class="card-img-top" alt="Image">
        <div class="card-body">
            <h6 class="card-title" th:text="${book.title}"></h6>
            <div><span th:text= "${book.price}"></span>$</div>
            <div><span th:text= "${book.quantity}"></span> pieces available</div>
            <input type="number" min="1" max="${book.quantity}" class="form-control quantity-input" id="quantity__${book.id}__" value="1">
            <a th:href="@{/books/add-to-cart/__${book.id}__}" class="btn btn-primary add-to-cart">Add to cart</a>
            <a th:href="@{/books/buy-now/__${book.id}__}" class="btn btn-primary buy-now">Buy now</a>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const addToCartButtons = document.querySelectorAll('.add-to-cart');
        const buyNowButtons = document.querySelectorAll('.buy-now');

        addToCartButtons.forEach(function (button) {
            button.addEventListener('click', function (event) {
                const quantity = button.parentElement.querySelector('.quantity-input').value;
                button.href += `?quantity=${quantity}`;
            });
        });

        buyNowButtons.forEach(function (button) {
            button.addEventListener('click', function (event) {
                const quantity = button.parentElement.querySelector('.quantity-input').value;
                button.href += `?quantity=${quantity}`;
            });
        });
    });
</script>
</body>
</html>
